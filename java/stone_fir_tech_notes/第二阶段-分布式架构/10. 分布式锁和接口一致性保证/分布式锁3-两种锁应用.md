## 47. 库存超卖场景

- 对于非高并发(小于5k), 使用分布式锁控制还可以.
-  **太多热点数据, 太热的数据, 那么分布式锁不是一个很好的解决方案.**不能把所有的请求都并行化, 那样分布式就没有意义了.



**下单控制并发:** 对同一个商品的下订单 -> 检查库存 -> 创建订单 -> 锁定库存, 所有的请求会串行化.

**出库流程控制并发:** 调度中心的"查询 -> 计算 -> 修改"三个过程串行化.

![10_调度销售出库问题的分布式锁解决方案](%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%813-%E4%B8%A4%E7%A7%8D%E9%94%81%E5%BA%94%E7%94%A8.assets/10_%E8%B0%83%E5%BA%A6%E9%94%80%E5%94%AE%E5%87%BA%E5%BA%93%E9%97%AE%E9%A2%98%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.png)









## 49. 电商系统基于分布式锁解决库存超卖

1. 引入curator/redisson依赖
2. 要保证有ZK/redis基础设施
3. 实现代码
4. **还要考虑基础设施挂掉后的降级**



## 51.测试并发情况的锁情况

zk的节点情况.



